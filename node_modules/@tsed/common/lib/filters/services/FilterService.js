"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const core_1 = require("@tsed/core");
const Provider_1 = require("../../di/class/Provider");
const service_1 = require("../../di/decorators/service");
const ProviderType_1 = require("../../di/interfaces/ProviderType");
const InjectorService_1 = require("../../di/services/InjectorService");
const UnknowFilterError_1 = require("../errors/UnknowFilterError");
const FilterRegistry_1 = require("../registries/FilterRegistry");
/**
 * @deprecated This service will be removed in a future release. Use injectorService directly.
 */
let FilterService = class FilterService extends core_1.ProxyMap {
    constructor(injectorService) {
        super(injectorService, { filter: { type: ProviderType_1.ProviderType.FILTER } });
        this.injectorService = injectorService;
    }
    /**
     *
     * @param target
     * @returns {ControllerProvider}
     */
    /* istanbul ignore next */
    static get(target) {
        return FilterRegistry_1.FilterRegistry.get(target);
    }
    /**
     *
     * @deprecated
     * @param target
     * @param provider
     */
    /* istanbul ignore next */
    static set(target, provider) {
        FilterRegistry_1.FilterRegistry.set(target, provider);
        return this;
    }
    /**
     * @deprecated
     * @param target
     */
    /* istanbul ignore next */
    static has(target) {
        return FilterRegistry_1.FilterRegistry.has(target);
    }
    /**
     * @deprecated
     * @param target
     * @param locals
     * @param designParamTypes
     * @returns {T}
     */
    /* istanbul ignore next */
    invoke(target, locals = new Map(), designParamTypes) {
        return this.injectorService.invoke(target, locals, designParamTypes);
    }
    /**
     * @deprecated
     * @param target
     * @param args
     * @returns {any}
     */
    invokeMethod(target, ...args) {
        const instance = this.injectorService.get(target);
        if (!instance || !instance.transform) {
            throw new UnknowFilterError_1.UnknowFilterError(target);
        }
        const [expression, request, response] = args;
        return instance.transform(expression, request, response);
    }
};
tslib_1.__decorate([
    core_1.Deprecated("FilterService.invoke(). Use injectorService.invoke instead of")
    /* istanbul ignore next */
    ,
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [core_1.Type, Map, Array]),
    tslib_1.__metadata("design:returntype", Object)
], FilterService.prototype, "invoke", null);
tslib_1.__decorate([
    core_1.Deprecated("FilterService.invoke(). Removed feature"),
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [core_1.Type, Object]),
    tslib_1.__metadata("design:returntype", Object)
], FilterService.prototype, "invokeMethod", null);
tslib_1.__decorate([
    core_1.Deprecated("static FilterService.get(). Removed feature.")
    /* istanbul ignore next */
    ,
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [core_1.Type]),
    tslib_1.__metadata("design:returntype", Object)
], FilterService, "get", null);
tslib_1.__decorate([
    core_1.Deprecated("static FilterService.set(). Removed feature.")
    /* istanbul ignore next */
    ,
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [core_1.Type, Provider_1.Provider]),
    tslib_1.__metadata("design:returntype", void 0)
], FilterService, "set", null);
tslib_1.__decorate([
    core_1.Deprecated("static FilterService.has(). Removed feature.")
    /* istanbul ignore next */
    ,
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [core_1.Type]),
    tslib_1.__metadata("design:returntype", Boolean)
], FilterService, "has", null);
FilterService = tslib_1.__decorate([
    service_1.Service(),
    tslib_1.__metadata("design:paramtypes", [InjectorService_1.InjectorService])
], FilterService);
exports.FilterService = FilterService;

//# sourceMappingURL=FilterService.js.map
